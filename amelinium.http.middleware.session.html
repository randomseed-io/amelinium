<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>amelinium.http.middleware.session documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" type="text/css" href="css/randomseed.css" /></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Amelinium</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="10_introduction.html"><div class="inner"><span>Introduction</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><a href="amelinium.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>amelinium</span></div></a></li><li class="depth-2 branch"><a href="amelinium.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-2"><a href="amelinium.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3"><a href="amelinium.auth.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2"><a href="amelinium.common.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-3"><a href="amelinium.common.oplog.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oplog</span></div></a></li><li class="depth-4"><a href="amelinium.common.oplog.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="amelinium.common.populators.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>populators</span></div></a></li><li class="depth-3"><a href="amelinium.common.swagger.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>swagger</span></div></a></li><li class="depth-2 branch"><a href="amelinium.core.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="amelinium.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></div></li><li class="depth-4"><a href="amelinium.http.client.twilio.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>twilio</span></div></a></li><li class="depth-3"><a href="amelinium.http.middleware.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.coercion.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coercion</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.content.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>content</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.format.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>format</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.headers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>headers</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.language.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>language</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.lazy-req.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lazy-req</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.populators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>populators</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.remote-ip.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remote-ip</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.middleware.roles.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>roles</span></div></a></li><li class="depth-4 branch current"><a href="amelinium.http.middleware.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-4"><a href="amelinium.http.middleware.validators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validators</span></div></a></li><li class="depth-3"><a href="amelinium.http.server.html"><div class="inner"><span class="tree" style="top: -424px;"><span class="top" style="height: 433px;"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-4 branch"><a href="amelinium.http.server.jetty.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jetty</span></div></a></li><li class="depth-4"><a href="amelinium.http.server.undertow.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>undertow</span></div></a></li><li class="depth-2"><a href="amelinium.i18n.html"><div class="inner"><span class="tree" style="top: -610px;"><span class="top" style="height: 619px;"></span><span class="bottom"></span></span><span>i18n</span></div></a></li><li class="depth-3"><a href="amelinium.i18n.pluralizers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pluralizers</span></div></a></li><li class="depth-2 branch"><a href="amelinium.locale.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>locale</span></div></a></li><li class="depth-2 branch"><a href="amelinium.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proto</span></div></div></li><li class="depth-3 branch"><a href="amelinium.proto.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3"><a href="amelinium.proto.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2 branch"><a href="amelinium.schemas.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>schemas</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></div></li><li class="depth-3"><a href="amelinium.server.ssl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ssl</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>types</span></div></div></li><li class="depth-3 branch"><a href="amelinium.types.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="amelinium.types.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-3 branch"><a href="amelinium.types.errors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>errors</span></div></a></li><li class="depth-3"><a href="amelinium.types.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2"><a href="amelinium.web.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>web</span></div></a></li><li class="depth-3"><a href="amelinium.web.taggers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>taggers</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-active"><div class="inner"><span>active</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-active-valid.3F"><div class="inner"><span>active-valid?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-allow-expired"><div class="inner"><span>allow-expired</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-allow-hard-expired"><div class="inner"><span>allow-hard-expired</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-allow-soft-expired"><div class="inner"><span>allow-soft-expired</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-any-id"><div class="inner"><span>any-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-calc-expired-core"><div class="inner"><span>calc-expired-core</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-calc-expired.3F"><div class="inner"><span>calc-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-calc-hard-expired.3F"><div class="inner"><span>calc-hard-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-calc-soft-expired.3F"><div class="inner"><span>calc-soft-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-check-encrypted"><div class="inner"><span>check-encrypted</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-config"><div class="inner"><span>config</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-config.3F"><div class="inner"><span>config?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-control"><div class="inner"><span>control</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-control.3F"><div class="inner"><span>control?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-correct-state.3F"><div class="inner"><span>correct-state?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-created"><div class="inner"><span>created</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-created-valid.3F"><div class="inner"><span>created-valid?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-db-id"><div class="inner"><span>db-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-db-sid"><div class="inner"><span>db-sid</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-db-sid-smap"><div class="inner"><span>db-sid-smap</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-db-sid-str"><div class="inner"><span>db-sid-str</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-db-token"><div class="inner"><span>db-token</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-del-all-vars.21"><div class="inner"><span>del-all-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-del-session-vars.21"><div class="inner"><span>del-session-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-del-user-vars.21"><div class="inner"><span>del-user-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-del-var.21"><div class="inner"><span>del-var!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-del-vars.21"><div class="inner"><span>del-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-delete-session-vars"><div class="inner"><span>delete-session-vars</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-delete-user-vars"><div class="inner"><span>delete-user-vars</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-empty"><div class="inner"><span>empty</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-empty.3F"><div class="inner"><span>empty?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-encrypt"><div class="inner"><span>encrypt</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-err-id"><div class="inner"><span>err-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-error"><div class="inner"><span>error</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-error.3F"><div class="inner"><span>error?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-expired.3F"><div class="inner"><span>expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-fetch-var.21"><div class="inner"><span>fetch-var!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-fetch-vars.21"><div class="inner"><span>fetch-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-gen-session-id"><div class="inner"><span>gen-session-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-get-last-active"><div class="inner"><span>get-last-active</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-get-session-by-id"><div class="inner"><span>get-session-by-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-get-var"><div class="inner"><span>get-var</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-get-variable-failed.3F"><div class="inner"><span>get-variable-failed?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-get-vars"><div class="inner"><span>get-vars</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-handler"><div class="inner"><span>handler</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-hard-expired.3F"><div class="inner"><span>hard-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-id"><div class="inner"><span>id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-id-field"><div class="inner"><span>id-field</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-identify-session-path-compile"><div class="inner"><span>identify-session-path-compile</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-inject"><div class="inner"><span>inject</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-insecure.3F"><div class="inner"><span>insecure?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-invalidate-cache.21"><div class="inner"><span>invalidate-cache!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-ip"><div class="inner"><span>ip</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-ip-state"><div class="inner"><span>ip-state</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-cache-almost-expired.3F"><div class="inner"><span>mem-cache-almost-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-cache-expired.3F"><div class="inner"><span>mem-cache-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-cache-time-left"><div class="inner"><span>mem-cache-time-left</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-cache-time-passed"><div class="inner"><span>mem-cache-time-passed</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-ctime"><div class="inner"><span>mem-ctime</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mem-etime"><div class="inner"><span>mem-etime</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mkbad"><div class="inner"><span>mkbad</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-mkgood"><div class="inner"><span>mkgood</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-not-empty-of"><div class="inner"><span>not-empty-of</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-not-empty.3F"><div class="inner"><span>not-empty?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-of"><div class="inner"><span>of</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-one-second"><div class="inner"><span>one-second</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-process"><div class="inner"><span>process</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-process-handler"><div class="inner"><span>process-handler</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-prolong"><div class="inner"><span>prolong</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-put-var.21"><div class="inner"><span>put-var!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-put-vars.21"><div class="inner"><span>put-vars!</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-refresh-times"><div class="inner"><span>refresh-times</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-salt-splitter"><div class="inner"><span>salt-splitter</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-same-ip.3F"><div class="inner"><span>same-ip?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-scrypt-options"><div class="inner"><span>scrypt-options</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-secure.3F"><div class="inner"><span>secure?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-security-failed.3F"><div class="inner"><span>security-failed?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-security-passed.3F"><div class="inner"><span>security-passed?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-session-key"><div class="inner"><span>session-key</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-session.3F"><div class="inner"><span>session?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-set-session"><div class="inner"><span>set-session</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-sid-match"><div class="inner"><span>sid-match</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-sid-valid.3F"><div class="inner"><span>sid-valid?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-soft-expired.3F"><div class="inner"><span>soft-expired?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-split-secure-sid"><div class="inner"><span>split-secure-sid</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-state"><div class="inner"><span>state</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-time-exceeded.3F"><div class="inner"><span>time-exceeded?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-token-splitter"><div class="inner"><span>token-splitter</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-update-last-active"><div class="inner"><span>update-last-active</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-user-email"><div class="inner"><span>user-email</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-user-id"><div class="inner"><span>user-id</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-valid.3F"><div class="inner"><span>valid?</span></div></a></li><li class="depth-1"><a href="amelinium.http.middleware.session.html#var-wrap-session"><div class="inner"><span>wrap-session</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">amelinium.http.middleware.session</h1><h4 class="added">added in 1.0.0</h4><div class="doc"><div class="markdown"><p>amelinium service, session middleware.</p>
</div></div><div class="public anchor" id="var-active"><h3>active</h3><div class="usage"><code>(active src)</code><code>(active src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-374">view source</a></div></div><div class="public anchor" id="var-active-valid.3F"><h3>active-valid?</h3><div class="usage"><code>(active-valid? src)</code><code>(active-valid? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-724">view source</a></div></div><div class="public anchor" id="var-allow-expired"><h3>allow-expired</h3><div class="usage"><code>(allow-expired src)</code><code>(allow-expired src session-key)</code></div><div class="doc"><div class="markdown"><p>Temporarily marks expired session as valid.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-810">view source</a></div></div><div class="public anchor" id="var-allow-hard-expired"><h3>allow-hard-expired</h3><div class="usage"><code>(allow-hard-expired src)</code><code>(allow-hard-expired src session-key)</code></div><div class="doc"><div class="markdown"><p>Temporarily mark hard-expired session as valid.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-838">view source</a></div></div><div class="public anchor" id="var-allow-soft-expired"><h3>allow-soft-expired</h3><div class="usage"><code>(allow-soft-expired src)</code><code>(allow-soft-expired src session-key)</code></div><div class="doc"><div class="markdown"><p>Temporarily mark soft-expired session as valid.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-829">view source</a></div></div><div class="public anchor" id="var-any-id"><h3>any-id</h3><div class="usage"><code>(any-id src)</code><code>(any-id src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-354">view source</a></div></div><div class="public anchor" id="var-calc-expired-core"><h3>calc-expired-core</h3><div class="usage"><code>(calc-expired-core exp last-active)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-655">view source</a></div></div><div class="public anchor" id="var-calc-expired.3F"><h3>calc-expired?</h3><div class="usage"><code>(calc-expired? src session-key)</code><code>(calc-expired? src)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-659">view source</a></div></div><div class="public anchor" id="var-calc-hard-expired.3F"><h3>calc-hard-expired?</h3><div class="usage"><code>(calc-hard-expired? src session-key)</code><code>(calc-hard-expired? src)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-666">view source</a></div></div><div class="public anchor" id="var-calc-soft-expired.3F"><h3>calc-soft-expired?</h3><div class="usage"><code>(calc-soft-expired? src session-key)</code><code>(calc-soft-expired? src)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-673">view source</a></div></div><div class="public anchor" id="var-check-encrypted"><h3>check-encrypted</h3><div class="usage"><code>(check-encrypted plain-token encrypted-token-b64-str)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-502">view source</a></div></div><div class="public anchor" id="var-config"><h3>config</h3><div class="usage"><code>(config src)</code><code>(config src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-342">view source</a></div></div><div class="public anchor" id="var-config.3F"><h3>config?</h3><div class="usage"><code>(config? v)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-47">view source</a></div></div><div class="public anchor" id="var-control"><h3>control</h3><div class="usage"><code>(control src)</code><code>(control src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-338">view source</a></div></div><div class="public anchor" id="var-control.3F"><h3>control?</h3><div class="usage"><code>(control? v)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-334">view source</a></div></div><div class="public anchor" id="var-correct-state.3F"><h3>correct-state?</h3><div class="usage"><code>(correct-state? state-result)</code><code>(correct-state? src ip-address)</code><code>(correct-state? src session-key ip-address)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if a session exists and its state is correct. Never throws an exception.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-773">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create src user-id user-email ip-address)</code></div><div class="doc"><div class="markdown"><p>Creates a new session and puts it into a database. Returns a session record.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1365">view source</a></div></div><div class="public anchor" id="var-created"><h3>created</h3><div class="usage"><code>(created src)</code><code>(created src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-370">view source</a></div></div><div class="public anchor" id="var-created-valid.3F"><h3>created-valid?</h3><div class="usage"><code>(created-valid? src)</code><code>(created-valid? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-720">view source</a></div></div><div class="public anchor" id="var-db-id"><h3>db-id</h3><div class="usage"><code>(db-id src)</code><code>(db-id src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-515">view source</a></div></div><div class="public anchor" id="var-db-sid"><h3>db-sid</h3><div class="usage"><code>(db-sid smap-or-sid)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-523">view source</a></div></div><div class="public anchor" id="var-db-sid-smap"><h3>db-sid-smap</h3><div class="usage"><code>(db-sid-smap smap)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-530">view source</a></div></div><div class="public anchor" id="var-db-sid-str"><h3>db-sid-str</h3><div class="usage"><code>(db-sid-str sid)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-535">view source</a></div></div><div class="public anchor" id="var-db-token"><h3>db-token</h3><div class="usage"><code>(db-token src)</code><code>(db-token src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-358">view source</a></div></div><div class="public anchor" id="var-del-all-vars.21"><h3>del-all-vars!</h3><div class="usage"><code>(del-all-vars! src session-key)</code><code>(del-all-vars! src)</code></div><div class="doc"><div class="markdown"><p>Deletes all session variables which belong to a user (is <code>single-session?</code> configuration option is <code>true</code>) or just variables for this session (if <code>single-session?</code> configuration option is <code>false</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1006">view source</a></div></div><div class="public anchor" id="var-del-session-vars.21"><h3>del-session-vars!</h3><div class="usage"><code>(del-session-vars! src session-key)</code><code>(del-session-vars! src)</code></div><div class="doc"><div class="markdown"><p>Deletes all session variables which belong to a user.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1037">view source</a></div></div><div class="public anchor" id="var-del-user-vars.21"><h3>del-user-vars!</h3><div class="usage"><code>(del-user-vars! src session-key)</code><code>(del-user-vars! src)</code></div><div class="doc"><div class="markdown"><p>Deletes all session variables which belong to a user across all sessions.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1026">view source</a></div></div><div class="public anchor" id="var-del-var.21"><h3>del-var!</h3><div class="usage"><code>(del-var! src var-name)</code><code>(del-var! src session-key var-name)</code></div><div class="doc"><div class="markdown"><p>Deletes a session variable <code>var-name</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-979">view source</a></div></div><div class="public anchor" id="var-del-vars.21"><h3>del-vars!</h3><div class="usage"><code>(del-vars! src var-names)</code><code>(del-vars! src session-key var-names)</code></div><div class="doc"><div class="markdown"><p>Deletes a session variables from <code>var-names</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-992">view source</a></div></div><div class="public anchor" id="var-delete-session-vars"><h3>delete-session-vars</h3><div class="usage"><code>(delete-session-vars opts db sessions-table variables-table db-id)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-900">view source</a></div></div><div class="public anchor" id="var-delete-user-vars"><h3>delete-user-vars</h3><div class="usage"><code>(delete-user-vars opts db sessions-table variables-table user-id)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-892">view source</a></div></div><div class="public anchor" id="var-empty"><h3>empty</h3><div class="usage"><code>(empty src)</code><code>(empty src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns an empty session record. Optional <code>session-key</code> may be given to express a key in associative structure (defaults to <code>:session</code>) used to perform a session lookup used to access the control object.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-307">view source</a></div></div><div class="public anchor" id="var-empty.3F"><h3>empty?</h3><div class="usage"><code>(empty? src)</code><code>(empty? src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns <code>false</code> is <code>src</code> contains a session or is a session, and the session has usable identifier set (<code>:id</code> or <code>:err-id</code> field is set) or has the <code>:error</code> field set. Optional <code>session-key</code> may be given to express a key in associative structure (defaults to <code>:session</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-291">view source</a></div></div><div class="public anchor" id="var-encrypt"><h3>encrypt</h3><div class="usage"><code>(encrypt plain-token)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-495">view source</a></div></div><div class="public anchor" id="var-err-id"><h3>err-id</h3><div class="usage"><code>(err-id src)</code><code>(err-id src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-350">view source</a></div></div><div class="public anchor" id="var-error"><h3>error</h3><div class="usage"><code>(error src)</code><code>(error src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-802">view source</a></div></div><div class="public anchor" id="var-error.3F"><h3>error?</h3><div class="usage"><code>(error? src)</code><code>(error? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-794">view source</a></div></div><div class="public anchor" id="var-expired.3F"><h3>expired?</h3><div class="usage"><code>(expired? src)</code><code>(expired? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-681">view source</a></div></div><div class="public anchor" id="var-fetch-var.21"><h3>fetch-var!</h3><div class="usage"><code>(fetch-var! src var-name)</code><code>(fetch-var! src session-key var-name)</code></div><div class="doc"><div class="markdown"><p>Like <code>get-var</code> but removes session variable after it is successfully read from a database. Variable is not removed if there was a problem with reading or de-serializing it.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1075">view source</a></div></div><div class="public anchor" id="var-fetch-vars.21"><h3>fetch-vars!</h3><div class="usage"><code>(fetch-vars! src var-names)</code><code>(fetch-vars! src session-key var-names)</code></div><div class="doc"><div class="markdown"><p>Like <code>get-vars</code> but removes session variable after it is successfully read from a database. Variables are not removed if there was a problem with reading or de-serializing them.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1093">view source</a></div></div><div class="public anchor" id="var-gen-session-id"><h3>gen-session-id</h3><div class="usage"><code>(gen-session-id smap secured? &amp; args)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-541">view source</a></div></div><div class="public anchor" id="var-get-last-active"><h3>get-last-active</h3><div class="usage"><code>(get-last-active opts db table sid-db remote-ip)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-869">view source</a></div></div><div class="public anchor" id="var-get-session-by-id"><h3>get-session-by-id</h3><div class="usage"><code>(get-session-by-id opts db table sid-db remote-ip)</code></div><div class="doc"><div class="markdown"><p>Standard session getter. Uses <code>db</code> to connect to a database and gets data identified by <code>sid</code> from a table <code>table</code>. Returns a map.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-863">view source</a></div></div><div class="public anchor" id="var-get-var"><h3>get-var</h3><div class="usage"><code>(get-var src var-name)</code><code>(get-var src session-key var-name)</code></div><div class="doc"><div class="markdown"><p>Gets a session variable and de-serializes it into a Clojure data structure.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1048">view source</a></div></div><div class="public anchor" id="var-get-variable-failed.3F"><h3>get-variable-failed?</h3><div class="usage"><code>(get-variable-failed? v)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if the value <code>v</code> obtained from a session variable indicates that it actually could not be successfully fetched from a database.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1139">view source</a></div></div><div class="public anchor" id="var-get-vars"><h3>get-vars</h3><div class="usage"><code>(get-vars src var-names)</code><code>(get-vars src session-key var-names)</code></div><div class="doc"><div class="markdown"><p>Gets a session variables and de-serializes them into a Clojure data structures.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1061">view source</a></div></div><div class="public anchor" id="var-handler"><h3>handler</h3><div class="usage"><code>(handler src sid remote-ip)</code><code>(handler src session-key sid remote-ip)</code><code>(handler ctrl session-key id-field sid remote-ip)</code></div><div class="doc"><div class="markdown"><p>Gets session data from a database and processes them with session control functions and configuration options to generate a session record. When the record is created it is validated for errors and expiration times.</p>
<p>The results of calling this function may be memoized to reduce database hits. Note that if the cache TTL is larger than the remaining expiration time for a session, it may be required to refresh the times and re-validate the session object (see <code>refresh-times</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1214">view source</a></div></div><div class="public anchor" id="var-hard-expired.3F"><h3>hard-expired?</h3><div class="usage"><code>(hard-expired? src)</code><code>(hard-expired? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-691">view source</a></div></div><div class="public anchor" id="var-id"><h3>id</h3><div class="usage"><code>(id src)</code><code>(id src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-346">view source</a></div></div><div class="public anchor" id="var-id-field"><h3>id-field</h3><div class="usage"><code>(id-field src)</code><code>(id-field src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-386">view source</a></div></div><div class="public anchor" id="var-identify-session-path-compile"><h3>identify-session-path-compile</h3><div class="usage"><code>(identify-session-path-compile path)</code></div><div class="doc"><div class="markdown"><p>Returns a function which takes a request map and returns a session ID.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-849">view source</a></div></div><div class="public anchor" id="var-inject"><h3>inject</h3><div class="usage"><code>(inject dst smap)</code><code>(inject dst smap session-key)</code></div><div class="doc"><div class="markdown"><p>Returns an object updated with session record of type <code>Session</code> under an optional <code>session-key</code> if session is to be put into an associative structure (defaults to <code>:session</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-314">view source</a></div></div><div class="public anchor" id="var-insecure.3F"><h3>insecure?</h3><div class="usage"><code>(insecure? src)</code><code>(insecure? src session-key)</code></div><div class="doc"><div class="markdown"><p>Checks if session is not secure where it should be. If <code>:secured?</code> option is not enabled in configuration, it returns <code>false</code>. If <code>:secure?</code> flag is set to a falsy value, it returns <code>false</code>. If there is no session, it returns <code>true</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-571">view source</a></div></div><div class="public anchor" id="var-invalidate-cache.21"><h3>invalidate-cache!</h3><div class="usage"><code>(invalidate-cache! src)</code><code>(invalidate-cache! src session-key)</code><code>(invalidate-cache! src session-key remote-ip)</code></div><div class="doc"><div class="markdown"><p>Invalidates cache for the specific session.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1147">view source</a></div></div><div class="public anchor" id="var-ip"><h3>ip</h3><div class="usage"><code>(ip src)</code><code>(ip src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-378">view source</a></div></div><div class="public anchor" id="var-ip-state"><h3>ip-state</h3><div class="usage"><code>(ip-state src session-key user-id user-email remote-ip)</code><code>(ip-state src user-id user-email remote-ip)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-617">view source</a></div></div><div class="public anchor" id="var-mem-cache-almost-expired.3F"><h3>mem-cache-almost-expired?</h3><div class="usage"><code>(mem-cache-almost-expired? ctrl key)</code><code>(mem-cache-almost-expired? ctrl key knee)</code><code>(mem-cache-almost-expired? ctrl key knee t)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if an entry associated with the given key <code>key</code> in a TTL map of a current handler cache has almost expired. The <code>knee</code> argument should be a number of milliseconds (defaults to 1000 if not given) to be added to a current time in order to shift it forward. If the entry does not exist, <code>true</code> is returned. Negative <code>knee</code> values will cause it to have 0 impact. Optional argument <code>t</code> may be given with a time expressed as an instant (<code>java.time.Instant</code>) to be used as a source of current time.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-423">view source</a></div></div><div class="public anchor" id="var-mem-cache-expired.3F"><h3>mem-cache-expired?</h3><div class="usage"><code>(mem-cache-expired? ctrl key t)</code><code>(mem-cache-expired? ctrl key)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if an entry associated with the given key <code>key</code> in a TTL map of a current handler cache has expired. If the entry does not exist, <code>true</code> is returned. Optional argument <code>t</code> may be given with a time expressed as an instant (<code>java.time.Instant</code>) to be used as a source of current time.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-409">view source</a></div></div><div class="public anchor" id="var-mem-cache-time-left"><h3>mem-cache-time-left</h3><div class="usage"><code>(mem-cache-time-left ctrl key)</code><code>(mem-cache-time-left ctrl key t)</code></div><div class="doc"><div class="markdown"><p>Returns a time left to a cache expiry for an entry associated with the given key <code>key</code> in a TTL map of a current handler cache. The returned object is of type <code>java.time.Duration</code>. If the entry does not exist, <code>nil</code> is returned. Optional <code>t</code> argument may be given to express current time as <code>java.time.Instant</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-444">view source</a></div></div><div class="public anchor" id="var-mem-cache-time-passed"><h3>mem-cache-time-passed</h3><div class="usage"><code>(mem-cache-time-passed ctrl key)</code><code>(mem-cache-time-passed ctrl key t)</code></div><div class="doc"><div class="markdown"><p>Returns a time which passed till now from the creation of an entry associated with the given key <code>key</code> in a TTL map of a current handler cache. The returned object is of type <code>java.time.Duration</code> and its value may exceed the configured TTL when there was no cache update nor eviction for the entry. Optional <code>t</code> argument may be given to express current time as <code>java.time.Instant</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-458">view source</a></div></div><div class="public anchor" id="var-mem-ctime"><h3>mem-ctime</h3><div class="usage"><code>(mem-ctime ctrl key)</code></div><div class="doc"><div class="markdown"><p>Retrieves an entry creation time (in milliseconds) associated with the given <code>key</code> in a TTL map of a current handler cache. If the entry does not exist, <code>nil</code> is returned.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-390">view source</a></div></div><div class="public anchor" id="var-mem-etime"><h3>mem-etime</h3><div class="usage"><code>(mem-etime ctrl key)</code></div><div class="doc"><div class="markdown"><p>Retrieves an expiration time (in milliseconds since the beginning of the Unix epoch) of an entry identified by the given key <code>key</code> in a TTL map of a current handler cache. It is calculated by adding caches TTL to entrys creation time. If the entry does not exist, <code>nil</code> is returned.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-398">view source</a></div></div><div class="public anchor" id="var-mkbad"><h3>mkbad</h3><div class="usage"><code>(mkbad smap k v a b c d &amp; pairs)</code><code>(mkbad smap k v a b c d)</code><code>(mkbad smap k v a b)</code><code>(mkbad smap k v)</code><code>(mkbad smap)</code></div><div class="doc"><div class="markdown"><p>Marks session as invalid and sets <code>:err-id</code> fields value to the value of <code>:id</code> field, then sets <code>:id</code> to <code>nil</code>. The given object should be a session.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-931">view source</a></div></div><div class="public anchor" id="var-mkgood"><h3>mkgood</h3><div class="usage"><code>(mkgood src session-key)</code><code>(mkgood src)</code></div><div class="doc"><div class="markdown"><p>Marks the given session <code>smap</code> as valid by setting <code>:valid?</code> field to <code>true</code>, <code>:expired?</code> and <code>:hard-expired?</code> fields to <code>false</code>, and <code>:error</code> field to <code>nil</code>. The given object should be a session.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-910">view source</a></div></div><div class="public anchor" id="var-not-empty-of"><h3>not-empty-of</h3><div class="usage"><code>(not-empty-of src)</code><code>(not-empty-of src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns a session if <code>src</code> contains a session or is a session, and the session has usable identifier set (<code>:id</code> or <code>:err-id</code> field is set) or has the <code>:error</code> field set. Optional <code>session-key</code> may be given to express a key in associative structure (defaults to <code>:session</code>). Returns <code>nil</code> if session is not usable (does not have <code>:id</code>, <code>:err-id</code> not <code>:error</code> set).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-321">view source</a></div></div><div class="public anchor" id="var-not-empty.3F"><h3>not-empty?</h3><div class="usage"><code>(not-empty? src)</code><code>(not-empty? src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> is <code>src</code> contains a session or is a session, and the session has usable identifier set (<code>:id</code> or <code>:err-id</code> field is set) or has the <code>:error</code> field set. Optional <code>session-key</code> may be given to express a key in associative structure (defaults to <code>:session</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-299">view source</a></div></div><div class="public anchor" id="var-of"><h3>of</h3><div class="usage"><code>(of src)</code><code>(of src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns a session record of type <code>Session</code> on a basis of configuration source provided and an optional <code>session-key</code> if session must be looked in an associative structure (defaults to <code>:session</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-284">view source</a></div></div><div class="public anchor" id="var-one-second"><h3>one-second</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-45">view source</a></div></div><div class="public anchor" id="var-process"><h3>process</h3><div class="usage"><code>(process ctrl malformed-session empty-session cache-margin expires-in req)</code></div><div class="doc"><div class="markdown"><p>Takes a session control object, functions, settings and a request map, and validates session against a database or memoized session data. Returns a session map or dummy session map if session was not obtained (session ID was not found in a database).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1316">view source</a></div></div><div class="public anchor" id="var-process-handler"><h3>process-handler</h3><div class="usage"><code>(process-handler ctrl cache-margin expires-in sid remote-ip)</code></div><div class="doc"><div class="markdown"><p>Session processing handler wrapper. For the given session ID <code>sid</code> and remote IP address <code>remote-ip</code> it runs <code>handle</code> (from <code>SessionControl</code> protocol) using <code>ctrl</code>. Then it quickly checks if the refresh is needed (by checking whether session is expired or by calling <code>needs-refresh?</code>). If re-reading expiration time from a database is required, it will do it and check if the time really has changed. In such case the session data in will be updated (by refreshing just the last active time or by handling it again after cache eviction).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1262">view source</a></div></div><div class="public anchor" id="var-prolong"><h3>prolong</h3><div class="usage"><code>(prolong src)</code><code>(prolong src ip-address)</code><code>(prolong src session-key ip-address)</code></div><div class="doc"><div class="markdown"><p>Re-validates session by updating its timestamp and re-running validation.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1340">view source</a></div></div><div class="public anchor" id="var-put-var.21"><h3>put-var!</h3><div class="usage"><code>(put-var! src var-name value)</code><code>(put-var! src session-key var-name value)</code></div><div class="doc"><div class="markdown"><p>Puts a session variable <code>var-name</code> with a value <code>value</code> into a database.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1112">view source</a></div></div><div class="public anchor" id="var-put-vars.21"><h3>put-vars!</h3><div class="usage"><code>(put-vars! src pairs)</code><code>(put-vars! src session-key pairs)</code></div><div class="doc"><div class="markdown"><p>Puts session variables with associated values (<code>var-names-values</code>) expressed as pairs into a database.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1124">view source</a></div></div><div class="public anchor" id="var-refresh-times"><h3>refresh-times</h3><div class="usage"><code>(refresh-times src)</code><code>(refresh-times src session-key)</code><code>(refresh-times src remote-ip)</code><code>(refresh-times src session-key remote-ip)</code></div><div class="doc"><div class="markdown"><p>Checks a last-active time of the session. If the time left to expiration is smaller than the cache TTL then the session record will be updated using a database query and session cache invalidated for a session ID. Uses pre-calculated value stored in the <code>:cache-margin</code> field of a session record (see <code>calc-cache-margin</code> for more info).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1178">view source</a></div></div><div class="public anchor" id="var-salt-splitter"><h3>salt-splitter</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-481">view source</a></div></div><div class="public anchor" id="var-same-ip.3F"><h3>same-ip?</h3><div class="usage"><code>(same-ip? state-result)</code><code>(same-ip? src user-id user-email remote-ip)</code><code>(same-ip? src session-key user-id user-email remote-ip)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-641">view source</a></div></div><div class="public anchor" id="var-scrypt-options"><h3>scrypt-options</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-475">view source</a></div></div><div class="public anchor" id="var-secure.3F"><h3>secure?</h3><div class="usage"><code>(secure? src)</code><code>(secure? src session-key)</code></div><div class="doc"><div class="markdown"><p>Checks if a session is secure according to configured security level. If <code>:secured?</code> option is not enabled in configuration, it returns <code>true</code>. If <code>:secure?</code> flag is set to a truthy value, it returns it.  If there is no session, it returns <code>false</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-556">view source</a></div></div><div class="public anchor" id="var-security-failed.3F"><h3>security-failed?</h3><div class="usage"><code>(security-failed? src)</code><code>(security-failed? src session-key)</code></div><div class="doc"><div class="markdown"><p>Checks if the additional security token was validated incorrectly unless the session is not secure (in such case it returns <code>false</code>). Does not test if session should be secured; to check it, use <code>secure?</code> or <code>insecure?</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-602">view source</a></div></div><div class="public anchor" id="var-security-passed.3F"><h3>security-passed?</h3><div class="usage"><code>(security-passed? src)</code><code>(security-passed? src session-key)</code></div><div class="doc"><div class="markdown"><p>Checks if the additional security token was validated correctly or there was not a need to validate it because the session is not secure (in such case returns <code>true</code>). Does not test if session should be secured; to check it, use <code>secure?</code> or <code>insecure?</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-586">view source</a></div></div><div class="public anchor" id="var-session-key"><h3>session-key</h3><div class="usage"><code>(session-key src)</code><code>(session-key src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-382">view source</a></div></div><div class="public anchor" id="var-session.3F"><h3>session?</h3><div class="usage"><code>(session? v)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-51">view source</a></div></div><div class="public anchor" id="var-set-session"><h3>set-session</h3><div class="usage"><code>(set-session opts db table smap)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-883">view source</a></div></div><div class="public anchor" id="var-sid-match"><h3>sid-match</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-43">view source</a></div></div><div class="public anchor" id="var-sid-valid.3F"><h3>sid-valid?</h3><div class="usage"><code>(sid-valid? sid)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-713">view source</a></div></div><div class="public anchor" id="var-soft-expired.3F"><h3>soft-expired?</h3><div class="usage"><code>(soft-expired? src)</code><code>(soft-expired? src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-701">view source</a></div></div><div class="public anchor" id="var-split-secure-sid"><h3>split-secure-sid</h3><div class="usage"><code>(split-secure-sid session-id)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-511">view source</a></div></div><div class="public anchor" id="var-state"><h3>state</h3><div class="usage"><code>(state smap ip-address)</code></div><div class="doc"><div class="markdown"><p>Returns session state. If there is anything wrong, returns a <code>SessionError</code> record. Otherwise it returns <code>nil</code>. Unknown session detection is performed by checking if a value associated with the <code>:id</code> key is <code>nil</code> and a value associated with the <code>:err-id</code> key is not <code>nil</code>. First argument must be a session object of type <code>Session</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-728">view source</a></div></div><div class="public anchor" id="var-time-exceeded.3F"><h3>time-exceeded?</h3><div class="usage"><code>(time-exceeded? dur max-dur)</code><code>(time-exceeded? t-start t-stop max-dur)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-649">view source</a></div></div><div class="public anchor" id="var-token-splitter"><h3>token-splitter</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-480">view source</a></div></div><div class="public anchor" id="var-update-last-active"><h3>update-last-active</h3><div class="usage"><code>(update-last-active opts db table sid-db remote-ip)</code><code>(update-last-active opts db table sid-db remote-ip t)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-875">view source</a></div></div><div class="public anchor" id="var-user-email"><h3>user-email</h3><div class="usage"><code>(user-email src)</code><code>(user-email src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-366">view source</a></div></div><div class="public anchor" id="var-user-id"><h3>user-id</h3><div class="usage"><code>(user-id src)</code><code>(user-id src session-key)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-362">view source</a></div></div><div class="public anchor" id="var-valid.3F"><h3>valid?</h3><div class="usage"><code>(valid? src)</code><code>(valid? src session-key)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if a session is marked as valid.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-783">view source</a></div></div><div class="public anchor" id="var-wrap-session"><h3>wrap-session</h3><div class="usage"><code>(wrap-session k config)</code></div><div class="doc"><div class="markdown"><p>Session maintaining middleware.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/amelinium/utils/tree/1.0.0/src/amelinium/http/middleware/session.clj#lines-1487">view source</a></div></div></div></body></html>